<style>
    .red{
        color:red;
    }
</style>

# 五、问题二模型的建立与求解
## 5.1 高钾、铅钡玻璃分类规律的描述性统计分析
本文首先将预处理好的附件表二中玻璃类别与14种化学组成成分的关系用散点图进行可视化分析，
得到“所有玻璃文物类别与成分关系图”、“风化玻璃文物类别与成分关系图”和“未风化玻璃文物类别与成分关系图”
对类别与成分之间的关系进行直观的定性分析； 随后计算类别与单个化学成分之间的$spearman$相关系数
对类别与成分之间的关系做定量分析。
### 5.1.1 统计规律的定性分析
所有玻璃文物类别与成分关系散点图如下：
![](../graph/成分分析/类别成分分析.png)
<center>图4-1 所有玻璃文物的类别与成分关系是散点图</center>

从图中可以看出：高钾玻璃的氧化钾含量基本上高于比铅钡玻璃，且有较明显的分界线；
而高钾玻璃的氧化铅含量普遍低于铅钡玻璃。
在二氧化硅含量方面，高钾玻璃的含量大多偏高，而铅钡玻璃的含量则相对中等，整体趋势高钾玻璃的二氧化硅含量更高，
但二者含量的交集也不少。

将预处理后的表二数据按照风化与否分别画出玻璃类别与化学成分含量的散点图如下：
![](../graph/成分分析/风化类别分析.png)
<center>图4-2 风化玻璃的类别与成分关系散点图</center>

![](../graph/成分分析/未风化类别分析.png)

从风化玻璃的类别与成分关系散点图可以看出：风化后的高钾玻璃的二氧化硅含量明显高于风化后的铅钡玻璃，
且可以看出风化后的高钾玻璃化学成分含量集中在二氧化硅上；
风化后的高钾玻璃不含氧化铅与氧化钡，而风化后的铅钡玻璃的氧化铅和氧化钡的含量很高；</br>
从未风化玻璃的类别与成分关系散点图可以看出：未风化的高钾玻璃在氧化纳、氧化钾和氧化钙含量上明显高于铅钡玻璃且有较明显的分界；
而未风化的高钾玻璃在氧化铅和氧化钡上含量明显低于铅钡玻璃。

### 5.1.2 统计规律的定量分析
在5.1.1节通过散点图进行了定性分析后，本文通过计算类别与各化学成分之间的$spearman$相关系数，
进一步分析玻璃分类的统计规律。</br>
首先，所有玻璃文物的类别与化学成分之间的$spearman$相关系数如下表所示：
<p class=red>插入 “excel里问题二待插入表”中的 “表4-1所有玻璃文物的类别与成分的spearman相关系数表 </p>
<center>表4-1 所有玻璃文物的类别与成分的spearman相关系数表</center>

从表中可以看出：在P值为0.01的条件下，玻璃类别与氧化铅、氧化钡有较强的相关性：氧化铅和氧化钡的含量越高，
越有可能是铅钡玻璃；其他相关性并不明显。  
接着分别分析风化与否的玻璃类别与化学成分之间的$spearman$相关系数，结果如下所示：
<p class=red>插入 “excel里问题二待插入表”中的 “表4-2未风化玻璃文物的类别与成分的spareman相关系数表 </p>

<center>表4-2 未风化玻璃文物的类别与成分的spearman相关系数表</center>


从未风化玻璃文物的类别与成分的spearman相关系数表中可以看出：在P值为0.01的条件下，玻璃类别与氧化铅、氧化钡和氧化钾有极强的相关性：氧化铅和氧化钡的含量越高， 越有可能是铅钡玻璃；而氧化钾的含量越高越有可能是高钾玻璃；</br>
从风化玻璃文物的类别与成分的spearman相关系数表中可以看出，在P值为0.01的条件下，玻璃类别与二氧化硅、氧化钡、氧化铅和氧化锶的含量有着一般的相关性：风化玻璃的二氧化硅含量越高，越有可能是高钾玻璃类型；氧化钡、氧化铅和氧化锶的含量越高，越有可能是铅钡玻璃类型。

### 5.1.3 分类规律总述
综合玻璃类别与化学成分散点图和$spearman$相关系数的分析可得：高钾玻璃的氧化钾含量明显高于铅钡玻璃；
高钾玻璃的氧化铅和氧化钡含量之和明显低于铅钡玻璃的氧化铅和氧化钡含量之和；
高钾玻璃的二氧化硅含量整体高于铅钡玻璃，但是二者的二氧化硅含量有明显的交集。
基于以上观测，我们推测通过$\frac{PbO+BaO}{K_{2}O}$这一比值可初步确定玻璃文物是高钾玻璃还是铅钡玻璃。

## 5.2 基于 Kmeans 。。。。。。的模型建立与求解
为选择化学成分指标对不同的类型进行亚类划分，本文采用了K-means无监督学习的方式实现聚类，进而得到亚分类依据的效果

### 5.2.1 剔除噪声影响

在两组不同的玻璃类型的数据中，都存在冗余数据的噪声，噪声的特点是，数据相对杂乱，无法对分类工作做出指引，且一定程度上存在干扰结果的可能。
基于这种考虑，我们通过。。。。。以剔除噪声。

### 5.2.2 确定最佳聚类数

K-means聚类分析存在超参数最佳聚类数K，本文使用了肘部法则和平均轮廓法实现K值的选取。
+ 肘部法则
  引入指标误差平方和SSE，随着K值升高，SSE值减小，当SSE与K值的关系到达拐点时，具有最好的分类效果，此时即可以挑选出不同特征的类别，又避免了过度分类。
$$SSE=\sum_{\mathrm{i}=1}^{\mathrm{k}} \sum_{p \in C_{i}}\left|p-m_{i}\right|^{2}$$
+ 轮廓系数法
  轮廓系数法的核心思想是通过调整K,以达到分类结果可以蔟内紧密，蔟外远离的效果，为了刻画这一效果，引入了指标$s(i)$,其计算公式如下所示：
  $$s(i)=\frac{b(i)-a(i)}{\max \{a(i), b(i)\}}=\left\{\begin{array}{c}
1-\frac{a(i)}{b(i)}, \quad a(i)<b(i) \\
0, \quad a(i)=b(i) \\
\frac{b(i)}{a(i)}-1, \quad a(i)>b(i)
\end{array}\right.$$
    其中，a(i)表示该样本点i到蔟内其他数据的平均距离，b(i)表示到临近蔟数据的平均距离；如果$s(i)$接近1，说明聚类效果好；s(i)接近-1，说明聚类存在失真;s(i)接近0，说明聚类效果效果差。

    分别使用两种方法得到的效果曲线如下所示：

    <p class=red>并排插入你的四张造假图片(两张高钾，两张铅钡)</p>

    由图可得，应该选取的K值为 。

### 5.2.3 k-means聚类过程

<p class=red>包含了图片展示，以及聚类结果说明，两组都要说明</p>

### 5.2.4 聚类模型的敏感度与准确度分析 
